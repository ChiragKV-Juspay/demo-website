// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Home from "./MobileScreens/Home.res.mjs";
import * as Login from "./MobileScreens/Login.res.mjs";
import * as React from "react";
import * as Caml_obj from "rescript/lib/es6/caml_obj.js";
import * as EnterPin from "./MobileScreens/EnterPin.res.mjs";
import * as Transfer from "./MobileScreens/Transfer.res.mjs";
import * as Accordion from "./Components/Accordion.res.mjs";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";
import * as Caml_option from "rescript/lib/es6/caml_option.js";
import * as EnterAmount from "./MobileScreens/EnterAmount.res.mjs";
import * as JsxRuntime from "react/jsx-runtime";
import * as TransactionCompleted from "./MobileScreens/TransactionCompleted.res.mjs";

function App(props) {
  var match = React.useState(function () {
        return "Login";
      });
  var setCurrentScreen = match[1];
  var currentScreen = match[0];
  var match$1 = React.useState(function () {
        return null;
      });
  var setUserData = match$1[1];
  var userData = match$1[0];
  var match$2 = React.useState(function () {
        return null;
      });
  var setTransactionsHistory = match$2[1];
  var match$3 = React.useState(function () {
        return null;
      });
  var setUserAssets = match$3[1];
  var match$4 = React.useState(function () {
        return null;
      });
  var setTransactionResult = match$4[1];
  var match$5 = React.useState(function () {
        return false;
      });
  var setShowAuthInitiated = match$5[1];
  var match$6 = React.useState(function () {
        return false;
      });
  var setShowTrasactionConfirm = match$6[1];
  var handlePrevScreen = function () {
    switch (currentScreen) {
      case "Login" :
          return ;
      case "Home" :
          return setCurrentScreen(function (param) {
                      return "Login";
                    });
      case "EnterAmount" :
          return setCurrentScreen(function (param) {
                      return "Transfer";
                    });
      case "EnterPin" :
          return setCurrentScreen(function (param) {
                      return "EnterAmount";
                    });
      case "Transfer" :
          return setCurrentScreen(function (param) {
                      return "Home";
                    });
      case "TransactionCompleted" :
          return setCurrentScreen(function (param) {
                      return "EnterPin";
                    });
      
    }
  };
  var handleNextScreen = function () {
    switch (currentScreen) {
      case "Login" :
          return setCurrentScreen(function (param) {
                      return "Home";
                    });
      case "Home" :
          return setCurrentScreen(function (param) {
                      return "Transfer";
                    });
      case "EnterAmount" :
          return setCurrentScreen(function (param) {
                      return "EnterPin";
                    });
      case "EnterPin" :
          return setCurrentScreen(function (param) {
                      return "TransactionCompleted";
                    });
      case "Transfer" :
          return setCurrentScreen(function (param) {
                      return "EnterAmount";
                    });
      case "TransactionCompleted" :
          return ;
      
    }
  };
  var fetchData = async function () {
    var response = await fetch("https://finternet-app-api.shuttleapp.rs/v1/users/exampleUserId");
    var json = await response.json();
    return setUserData(function (param) {
                return json;
              });
  };
  var fetchUserAssets = async function () {
    var response = await fetch("https://finternet-app-api.shuttleapp.rs/v1/users/exampleUserId/assets");
    var json = await response.json();
    return setUserAssets(function (param) {
                return json;
              });
  };
  var fetchUserTransactionsHistory = async function () {
    var response = await fetch("https://finternet-app-api.shuttleapp.rs/v1/users/exampleUserId/assets/123/history");
    var json = await response.json();
    return setTransactionsHistory(function (param) {
                return json;
              });
  };
  var handleNavigateToHome = function () {
    setCurrentScreen(function (param) {
          return "Home";
        });
    fetchData();
    fetchUserTransactionsHistory();
    fetchUserAssets();
  };
  var performTransfer = function () {
    var postTransfer = async function () {
      var transferBody = {
        sender: "arnab.d@unifiedledger1",
        recipient: "ales@ledger",
        asset: {
          currency: "USD",
          unit: 200,
          token_manager: "tokenManagerAddress"
        },
        signature: "signature"
      };
      var response = await fetch("https://finternet-app-api.shuttleapp.rs/v1/users/exampleUserId/assets/123/asset:transfer", {
            method: "POST",
            body: Caml_option.some(Belt_Option.getExn(JSON.stringify(transferBody))),
            headers: Caml_option.some(new Headers({
                      "Content-type": "application/json"
                    }))
          });
      var json = await response.json();
      return setTransactionResult(function (param) {
                  return json;
                });
    };
    postTransfer();
  };
  var handleNavigateToTransactionCompleted = function () {
    setCurrentScreen(function (param) {
          return "TransactionCompleted";
        });
    setShowTrasactionConfirm(function (param) {
          return true;
        });
    performTransfer();
  };
  var handleNavigateToEnterPin = function () {
    setCurrentScreen(function (param) {
          return "EnterPin";
        });
    setShowAuthInitiated(function (param) {
          return true;
        });
  };
  var renderContent = function () {
    switch (currentScreen) {
      case "Login" :
          return JsxRuntime.jsx(Login.make, {
                      onNavigateToHome: (function () {
                          handleNavigateToHome();
                        })
                    });
      case "Home" :
          return JsxRuntime.jsx(Home.make, {
                      onNavigateToReceiversList: (function () {
                          setCurrentScreen(function (param) {
                                return "Transfer";
                              });
                        })
                    });
      case "EnterAmount" :
          return JsxRuntime.jsx(EnterAmount.make, {
                      onNavigateToEnterPin: (function (param) {
                          handleNavigateToEnterPin();
                        })
                    });
      case "EnterPin" :
          return JsxRuntime.jsx(EnterPin.make, {
                      onNavigateToTransactionCompleted: (function (param) {
                          handleNavigateToTransactionCompleted();
                        })
                    });
      case "Transfer" :
          return JsxRuntime.jsx(Transfer.make, {
                      onNavigateToEnterAmount: (function (param) {
                          setCurrentScreen(function (param) {
                                return "EnterAmount";
                              });
                        })
                    });
      case "TransactionCompleted" :
          return JsxRuntime.jsx(TransactionCompleted.make, {
                      onNavigateToHome: (function (param) {
                          setCurrentScreen(function (param) {
                                return "Home";
                              });
                        })
                    });
      
    }
  };
  return JsxRuntime.jsxs("div", {
              children: [
                JsxRuntime.jsxs("div", {
                      children: [
                        JsxRuntime.jsx("img", {
                              className: "h-10 w-10",
                              alt: "Description of image",
                              src: "/finternetLogo.png"
                            }),
                        JsxRuntime.jsx("div", {
                              children: "Playground",
                              className: "self-center"
                            })
                      ],
                      className: "absolute top-4 left-4 flex flex-row gap-1"
                    }),
                JsxRuntime.jsxs("div", {
                      children: [
                        JsxRuntime.jsx("div", {
                              children: renderContent(),
                              className: "bg-white h-4/5 self-center w-full p-4 shadow-lg rounded-lg   "
                            }),
                        JsxRuntime.jsxs("div", {
                              children: [
                                JsxRuntime.jsx("button", {
                                      children: "<",
                                      onClick: (function (param) {
                                          handlePrevScreen();
                                        })
                                    }),
                                JsxRuntime.jsx("button", {
                                      children: ">",
                                      onClick: (function (param) {
                                          handleNextScreen();
                                        })
                                    })
                              ],
                              className: " flex flex-row justify-around text-xl text-gray-400"
                            })
                      ],
                      className: "flex flex-col h-full w-1/5 justify-center gap-4"
                    }),
                JsxRuntime.jsxs("div", {
                      children: [
                        JsxRuntime.jsx("div", {
                              children: "Domestic Transfer Activity Log",
                              className: "text-2xl"
                            }),
                        Caml_obj.notequal(userData, null) ? JsxRuntime.jsx(Accordion.make, {
                                userData: userData,
                                userAssets: match$3[0],
                                transactionsHistory: match$2[0],
                                showAuthInitiated: match$5[0],
                                showTransactionConfirm: match$6[0],
                                transactionResult: match$4[0]
                              }) : JsxRuntime.jsx("div", {
                                children: "Initiate transaction to view activity logs",
                                className: "text-sm"
                              })
                      ],
                      className: "ml-4 p-4  bg-gray-100 rounded-lg w-3/5 h-full flex flex-col gap-3 overflow-auto"
                    })
              ],
              className: "flex justify-center  h-screen w-screen flex-row  jc p-4  font-space-grotesk "
            });
}

var make = App;

export {
  make ,
}
/* Home Not a pure module */
